<%- include('partials/header', { title: 'Đăng nhập' }) %>

<section class="auth-container fade-in-up">
  <h2 class="auth-title">Đăng nhập</h2>

  <% if (locals.msg === 'logout') { %>
    <p class="alert-inline-success">Đã đăng xuất.</p>
  <% } else if (locals.msg === 'register_ok') { %>
    <p class="alert-inline-success">Tạo tài khoản thành công. Vui lòng đăng nhập.</p>
  <% } else if (locals.msg === 'reset_ok') { %>
    <p class="alert-inline-success">Mật khẩu đã được cập nhật. Bạn có thể đăng nhập ngay.</p>
  <% } else if (locals.msg === 'otp_required') { %>
    <p class="alert-inline-error">Vui lòng xác thực OTP trước khi tiếp tục.</p>
  <% } %>

  <% if ((typeof error !== 'undefined' ? error : locals.error)) { %>
    <p class="alert-inline-error"><%= (typeof error !== 'undefined' ? error : locals.error) %></p>
  <% } %>

  <div class="auth-card">
    <form method="POST" action="/auth/login">
      <input type="hidden" name="next" value="<%= typeof next !== 'undefined' ? next : (locals.next || '') %>">
      <label>Email
        <input type="email" name="email" required />
      </label>
      <label>Mật khẩu
        <input type="password" name="password" required />
      </label>
      <div class="auth-actions">
        <button class="btn btn-primary" type="submit">Đăng nhập</button>
      </div>
    </form>

    <% if (locals.googleAuthEnabled) { %>
      <div class="oauth-buttons">
        <a class="btn btn-google" href="/auth/google">Đăng nhập bằng Google</a>
      </div>
    <% } %>

    <p class="auth-switch"><a href="/auth/forgot">Quên mật khẩu?</a></p>
  </div>
</section>

<%- include('partials/footer') %>
